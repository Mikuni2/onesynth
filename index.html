<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OneSynth</title>

  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f4f6f8;
      margin:0;
      padding:40px 16px;
      color:#132238;
    }

    .card{
      max-width:520px;
      margin:0 auto;
      background:#fff;
      padding:24px;
      border-radius:14px;
      box-shadow:0 8px 22px rgba(0,0,0,.08);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:12px;
    }

    .brand img{ height:42px; }

    h1{ margin:0; font-size:26px; }

    .subtitle{
      background:#2b6fd3;
      color:#fff;
      padding:12px 14px;
      border-radius:10px;
      margin:12px 0 16px;
      font-size:15px;
    }

    .info{
      background:#eef5ff;
      padding:10px 12px;
      border-radius:10px;
      font-size:13px;
      margin-bottom:16px;
    }

    label{ font-size:14px; }

    input{
      width:100%;
      padding:12px;
      margin:8px 0 14px;
      border-radius:10px;
      border:1px solid #cfd6df;
      font-size:14px;
    }

    button{
      width:100%;
      padding:13px;
      background:#3fa66a;
      color:#fff;
      border:none;
      border-radius:10px;
      font-size:15px;
      font-weight:700;
      cursor:pointer;
    }

    button:disabled{ opacity:.6; }

    .error{
      background:#fdecea;
      color:#611a15;
      padding:10px 12px;
      border-radius:10px;
      margin-top:14px;
      display:none;
      font-size:13px;
    }

    .report{
      margin-top:18px;
      display:none;
      white-space:pre-wrap;
      font-size:14px;
      line-height:1.45;
    }

    .loading{
      font-style:italic;
      color:#555;
    }
  </style>
</head>

<body>
  <div class="card">
    <div class="brand">
      <img src="Logo.png" alt="OneSynth logo">
      <h1>OneSynth</h1>
    </div>

    <div class="subtitle">
      Síntese isenta de reviews de hóspedes para apoiar a recomendação hoteleira
    </div>

    <div class="info">
      ℹ️ Sistema otimizado: 5 reviews por análise (mais rápido e económico)
    </div>

    <label>Nome do Hotel, Cidade</label>
    <input id="hotel" placeholder="ex: Hotel CR7, Funchal">

    <button id="btn" onclick="analisar()">Gerar Conclusão</button>

    <div id="error" class="error"></div>
    <div id="report" class="report"></div>
  </div>

<script>
 const API_BASE = "https://onesynth-1.onrender.com";

  async function analisar(){
    const hotel = document.getElementById("hotel").value.trim();
    const btn = document.getElementById("btn");
    const error = document.getElementById("error");
    const report = document.getElementById("report");

    error.style.display = "none";
    report.style.display = "none";

    if(!hotel){
      error.innerText = "❌ Insere o nome do hotel.";
      error.style.display = "block";
      return;
    }

    btn.disabled = true;
    btn.innerText = "A analisar…";

    report.innerHTML = "<div class='loading'>⏳ A processar…</div>";
    report.style.display = "block";

    try{
      const res = await fetch(`${API_BASE}/analyze-apify`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ hotel_name: hotel })
      });

      if(!res.ok) throw new Error("Erro no backend");

      const data = await res.json();
      report.innerText = data.result_markdown || "Sem conteúdo.";

    }catch(err){
      error.innerHTML = `❌ ${err.message}<br><small>${API_BASE}</small>`;
      error.style.display = "block";
      report.style.display = "none";
    }finally{
      btn.disabled = false;
      btn.innerText = "Gerar Conclusão";
    }
  }
</script>

</body>
</html>
